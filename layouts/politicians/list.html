{{ define "main" }}

<header class="page-header prose md:prose-lg prose-headings:mb-2 max-w-none">
  <h1 class="page-title">{{ .Title }}</h1>
  {{ with .Params.description }}
  <p class="page-subtitle">{{ . }}</p>
  {{ end }}
</header>

<p class="lead">
  {{ .Params.intro | default
    "Use the filters below to browse the Members of the European Parliament (MEPs), or search by name, party, or handle. Soon youâ€™ll also be able to copy the relevant email list and send a message urging the MEPs to leave X."
  }}
</p>

<div id="politician-stats" class="politician-stats"></div>

<div class="politician-filters">

  {{ if not (.Params.hideLevelFilter | default false) }}
  <div class="filter-field">
    <label for="filter-level" class="filter-label">Level</label>
    <select id="filter-level" class="filter-input">
      <option value="">All levels</option>
      <option value="eu">EU level</option>
      <option value="national">National</option>
    </select>
  </div>
  {{ end }}

  {{ if not (.Params.hideCountryFilter | default false) }}
  <div class="filter-field">
    <label for="filter-country" class="filter-label">Country</label>
    <select id="filter-country" class="filter-input">
      <option value="">All countries</option>
      <!-- options filled by JS -->
    </select>
  </div>
  {{ end }}

  <div class="filter-field">
    <label for="filter-xstatus" class="filter-label">Status</label>
    <select id="filter-xstatus" class="filter-input">
      <option value="">All</option>
      <option value="active">Active on X</option>
      <option value="inactive">Inactive (still has an X account)</option>
      <option value="none">Not on X</option>
    </select>
  </div>

  <div class="filter-field filter-field--grow">
    <label for="politician-search" class="filter-label">Search</label>
    <input
      type="search"
      id="politician-search"
      class="filter-input filter-input--search"
      placeholder="e.g. Germany, Greens, @handle, name..."
    >
  </div>
</div>


<div id="politician-list" class="politician-list"></div>

{{ $path := .Params.dataPath | default (slice "politicians" "eu" "meps") }}
{{ $data := collections.Index .Site.Data $path }} 

<script>
  window.POLITICIANS = {{ $data | jsonify }};
  window.POLITICIANS_DEFAULTS = {{ dict
    "defaultCountry" (.Params.defaultCountry | default "")
    "hideCountryFilter" (.Params.hideCountryFilter | default false)
  | jsonify }};
</script>

{{ $search := resources.Get "js/search.js" | js.Build (dict "format" "iife") | minify }}
<script src="{{ $search.RelPermalink }}" defer></script>


{{ end }}